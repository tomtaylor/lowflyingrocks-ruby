oh god all this code is so ugly
